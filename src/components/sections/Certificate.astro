---
import Section from "@/components/Section.astro";
import CertGallery from "@/components/CertGallery.jsx";
import { certificates } from "@cv";
import type { ImageMetadata } from "astro";

// Cargamos todas las imágenes con metadata
const images = import.meta.glob("../../assets/img/*", {
  eager: true,
  import: "default"
}) as Record<string, ImageMetadata>;

// Mapeamos filename → metadata
const imageMap: Record<string, ImageMetadata> = {};

for (const [path, data] of Object.entries(images)) {
  const filename = path.split("/").pop(); // ejemplo "proyecto1.webp"
  if (filename) imageMap[filename] = data;
}

const getImage = (filename: string) => {
  return imageMap[filename]?.src ?? null;
};


const certificatesWithImages = certificates.map((item) => {
  const url = item.url ?? "";
  const filename = String(url).split("/").pop();
  const resolved = filename ? getImage(filename) : null;
  return {
    ...item,
    imgSrc: resolved ?? url,
  };
});


---

<Section title="Certificaciones">
  <CertGallery client:load items={certificatesWithImages} />
</Section>
   

